<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FDJ Live Rates - Ultra Fast</title>
<link rel="preconnect" href="https://api.auragold.in">
<style>
    /* Compact CSS for performance */
    *{box-sizing:border-box;margin:0;padding:0;font-family:system-ui,-apple-system,sans-serif;}
    body{min-height:100vh;background:#0f172a;display:flex;justify-content:center;align-items:center;color:#fff;}
    .dashboard{width:90%;max-width:400px;background:rgba(30,41,59,0.7);backdrop-filter:blur(20px);border-radius:24px;padding:24px;border:1px solid rgba(255,255,255,0.1);box-shadow:0 25px 50px -12px rgba(0,0,0,0.5);}
    .header{text-align:center;margin-bottom:20px;}
    .header h1{font-size:22px;letter-spacing:-0.5px;}
    .section{background:rgba(255,255,255,0.05);border-radius:16px;padding:16px;margin-bottom:12px;transition: transform 0.2s ease;}
    .row{display:flex;justify-content:space-between;margin:6px 0;font-size:18px;}
    .label{color:#94a3b8;font-size:14px;}
    .value{font-variant-numeric: tabular-nums;font-weight:600;color:#fbbf24;}
    .time{text-align:right;font-size:11px;color:#64748b;margin-top:8px;}
    .flash { animation: flash-green 0.5s ease-out; }
    @keyframes flash-green { from { color: #4ade80; } to { color: inherit; } }
</style>
</head>
<body>

<div class="dashboard">
    <div class="header">
        <h1>FDJ Metal Live</h1>
    </div>

    <div class="section" id="gold-card">
        <div class="label">ðŸ¥‡ Gold 24K</div>
        <div class="row"><span>Buy</span><span class="value" id="gBuy">...</span></div>
        <div class="row"><span>Sell</span><span class="value" id="gSell">...</span></div>
        <div id="gTime" class="time">Connecting...</div>
    </div>

    <div class="section" id="silver-card">
        <div class="label">ðŸ¥ˆ Silver</div>
        <div class="row"><span>Buy</span><span class="value" id="sBuy">...</span></div>
        <div class="row"><span>Sell</span><span class="value" id="sSell">...</span></div>
        <div id="sTime" class="time">Connecting...</div>
    </div>
</div>

<script>
    const G_API = "https://api.auragold.in/api/data/v1/prices?product=24KGOLD";
    const S_API = "https://api.auragold.in/api/data/v1/prices?product=24KSILVER";

    // Fast Date Formatter (Native JS is faster than toLocaleString)
    const fastDate = (str) => {
        if(!str) return "--";
        const d = new Date(str);
        return d.getHours().toString().padStart(2,'0') + ":" + 
               d.getMinutes().toString().padStart(2,'0') + ":" + 
               d.getSeconds().toString().padStart(2,'0');
    };

    async function updatePrice() {
        try {
            // Fetch both in parallel with high priority
            const [gRes, sRes] = await Promise.all([
                fetch(G_API, { priority: 'high' }).then(r => r.json()),
                fetch(S_API, { priority: 'high' }).then(r => r.json())
            ]);

            const g = gRes.data;
            const s = sRes.data;

            // Update DOM inside a single animation frame for zero jank
            requestAnimationFrame(() => {
                updateElement("gBuy", g.aura_buy_price);
                updateElement("gSell", g.aura_sell_price);
                document.getElementById("gTime").textContent = "Last Sync: " + fastDate(g.created_at);

                updateElement("sBuy", s.aura_buy_price);
                updateElement("sSell", s.aura_sell_price);
                document.getElementById("sTime").textContent = "Last Sync: " + fastDate(s.created_at);
            });

        } catch (e) {
            console.error("Latency Error:", e);
            // Fallback to Proxy only if direct fetch fails (CORS check)
            attemptProxyFallback();
        }
    }

    function updateElement(id, val) {
        const el = document.getElementById(id);
        const newVal = "â‚¹" + parseFloat(val).toLocaleString('en-IN');
        if (el.textContent !== newVal) {
            el.textContent = newVal;
            el.classList.add('flash');
            setTimeout(() => el.classList.remove('flash'), 600);
        }
    }

    async function attemptProxyFallback() {
        const PROXY = "https://api.allorigins.win/raw?url=";
        const [gRes, sRes] = await Promise.all([
            fetch(PROXY + encodeURIComponent(G_API)).then(r => r.json()),
            fetch(PROXY + encodeURIComponent(S_API)).then(r => r.json())
        ]);
        // Same update logic... (omitted for brevity)
    }

    // Initial load
    updatePrice();
    // High frequency refresh (Every 15 seconds instead of 60)
    setInterval(updatePrice, 15000);
</script>
</body>
</html>
